<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ Habit Tracker Â· Cricket & Couple Themes</title>
  <link rel="stylesheet" href="style.css" />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=Bebas+Neue&family=Dancing+Script:wght@700&display=swap"
    rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
  <!-- Welcome Screen (First Time Setup) -->
  <div id="welcome-overlay" class="welcome-overlay hidden">
    <div class="welcome-box">
      <div class="welcome-header">
        <div class="welcome-logo">ğŸğŸ’‘</div>
        <h2>Welcome to Couple Goals</h2>
        <p>Your shared journey of growth and habits starts here.</p>
      </div>

      <div class="welcome-form">
        <div class="welcome-input-group">
          <label>Your Name</label>
          <input type="text" id="welcome-name-input" placeholder="How should your partner see you?" maxlength="20" />
        </div>

        <div class="welcome-input-group">
          <label>Which partner are you?</label>
          <div class="identity-selector">
            <button class="identity-btn p1" id="id-btn-1">
              <span class="id-icon">ğŸ’™</span>
              <span class="id-label">Partner 1</span>
            </button>
            <button class="identity-btn p2" id="id-btn-2">
              <span class="id-icon">â¤ï¸</span>
              <span class="id-label">Partner 2</span>
            </button>
          </div>
        </div>

        <div class="welcome-footer">
          <button id="btn-start-journey" class="btn-start-journey" disabled>Start Our Journey âœ¨</button>
          <p class="welcome-hint">You can change these later in settings.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Commentary Banner -->
  <div id="commentary-banner" class="commentary-banner hidden">
    <span id="commentary-text"></span>
  </div>

  <!-- ============ THEME SWITCHER ============ -->
  <div class="theme-switcher" id="theme-switcher">
    <button class="theme-btn active" data-theme="cricket" id="theme-cricket">ğŸ Cricket Mode</button>
    <button class="theme-btn" data-theme="couple" id="theme-couple">ğŸ’‘ Couple Mode</button>
  </div>

  <!-- =================== CRICKET THEME =================== -->
  <div id="cricket-app" class="app-theme">
    <header class="top-nav cricket-nav">
      <div class="nav-brand">ğŸ Cricket Habit Tracker</div>
      <div class="nav-tabs">
        <button class="tab-btn active" data-tab="home" data-app="cricket">ğŸ  Home</button>
        <button class="tab-btn" data-tab="habits" data-app="cricket">ğŸ“‹ Habits</button>
        <button class="tab-btn" data-tab="gameday" data-app="cricket">ğŸŸï¸ Game Day</button>
        <button class="tab-btn" data-tab="history" data-app="cricket">ğŸ“œ History</button>
      </div>
      <div class="nav-date" id="cricket-current-date"></div>
    </header>

    <!-- HOME TAB -->
    <main class="tab-content active" id="cricket-tab-home">
      <div class="home-grid">
        <section class="player-card card">
          <div class="player-badge" id="player-level-badge">Rookie</div>
          <div class="player-arena">
            <div class="player-aura" id="player-aura"></div>
            <div class="player-svg" id="player-svg"></div>
            <div class="player-ground"></div>
          </div>
          <div class="player-info">
            <h2 class="player-name" id="player-name" title="Click to rename">Your Cricketer</h2>
            <div class="player-level-bar">
              <div class="level-fill" id="level-fill"></div>
            </div>
            <div class="player-level-label" id="level-label">Level 1 Â· Rookie</div>
          </div>
        </section>

        <section class="stats-grid card">
          <h3 class="section-title">ğŸ“Š Batting Stats</h3>
          <div class="stats-row">
            <div class="stat-box">
              <div class="stat-icon">ğŸ”¥</div>
              <div class="stat-val" id="stat-streak">0</div>
              <div class="stat-lbl">Streak</div>
            </div>
            <div class="stat-box">
              <div class="stat-icon">ğŸƒ</div>
              <div class="stat-val" id="stat-runs">0</div>
              <div class="stat-lbl">Total Runs</div>
            </div>
            <div class="stat-box">
              <div class="stat-icon">ğŸ</div>
              <div class="stat-val" id="stat-avg">0.00</div>
              <div class="stat-lbl">Batting Avg</div>
            </div>
            <div class="stat-box">
              <div class="stat-icon">âš¡</div>
              <div class="stat-val" id="stat-best">0</div>
              <div class="stat-lbl">Best Streak</div>
            </div>
            <div class="stat-box">
              <div class="stat-icon">âŒ</div>
              <div class="stat-val" id="stat-wickets">0</div>
              <div class="stat-lbl">Wickets Lost</div>
            </div>
            <div class="stat-box">
              <div class="stat-icon">â­</div>
              <div class="stat-val" id="stat-xp">0</div>
              <div class="stat-lbl">XP</div>
            </div>
          </div>
        </section>

        <section class="todays-innings card">
          <div class="innings-header">
            <h3 class="section-title">ğŸ Today's Innings</h3>
            <div class="runs-today"><span id="runs-today-val">0</span> <span class="runs-label">runs today</span></div>
          </div>
          <div class="innings-progress-bar">
            <div class="innings-fill" id="innings-fill"></div>
          </div>
          <div id="today-habits-list" class="today-habits-list">
            <p class="empty-msg">No habits added yet. Go to the Habits tab! ğŸ</p>
          </div>
          <button class="btn-primary btn-submit-day" id="btn-submit-day">Submit Day's Innings âœ…</button>
        </section>

        <section class="unlocks card">
          <h3 class="section-title">ğŸ† Unlocked Gear</h3>
          <div id="unlocks-grid" class="unlocks-grid">
            <div class="unlock-item locked" data-unlock="helmet" title="Helmet â€“ 3-day streak">ğŸª–</div>
            <div class="unlock-item locked" data-unlock="gloves" title="Gloves â€“ 7-day streak">ğŸ§¤</div>
            <div class="unlock-item locked" data-unlock="bat" title="Golden Bat â€“ 14-day streak">ğŸ</div>
            <div class="unlock-item locked" data-unlock="trophy" title="Trophy â€“ 21-day streak">ğŸ†</div>
            <div class="unlock-item locked" data-unlock="star" title="Legend Star â€“ 30-day streak">â­</div>
            <div class="unlock-item locked" data-unlock="crown" title="Crown â€“ 50-day streak">ğŸ‘‘</div>
          </div>
        </section>
      </div>
    </main>

    <!-- HABITS TAB -->
    <main class="tab-content" id="cricket-tab-habits">
      <div class="habits-container">
        <section class="card add-habit-card">
          <h3 class="section-title">â• Add New Habit</h3>
          <div class="add-habit-form">
            <input type="text" id="habit-name-input" placeholder="e.g. Morning Run, Read 30 mins..." maxlength="50" />
            <select id="habit-category">
              <option value="health">ğŸƒ Health</option>
              <option value="mind">ğŸ§  Mind</option>
              <option value="skill">âš¡ Skill</option>
              <option value="social">ğŸ‘¥ Social</option>
              <option value="other">ğŸ¯ Other</option>
            </select>
            <button class="btn-primary" id="btn-add-habit">Add Habit</button>
          </div>
        </section>
        <section class="card">
          <h3 class="section-title">ğŸ“‹ Your Habits</h3>
          <div id="habits-manage-list" class="habits-manage-list">
            <p class="empty-msg">No habits yet.</p>
          </div>
        </section>
      </div>
    </main>

    <!-- GAME DAY TAB -->
    <main class="tab-content" id="cricket-tab-gameday">
      <div class="gameday-container">
        <section class="card schedule-card">
          <h3 class="section-title">ğŸŸï¸ Schedule a Game Day</h3>
          <div class="schedule-form">
            <label>Game Day Name</label>
            <input type="text" id="gd-name" placeholder="e.g. Weekend Match..." />
            <label>Date</label>
            <input type="date" id="gd-date" />
            <label>Opponent</label>
            <input type="text" id="gd-opponent" placeholder="e.g. Laziness XI..." />
            <button class="btn-primary" id="btn-schedule-gd">Schedule Game Day ğŸŸï¸</button>
          </div>
        </section>
        <section class="card scoreboard-card" id="active-scoreboard">
          <h3 class="section-title">ğŸ† Active Scoreboard</h3>
          <div id="scoreboard-content">
            <p class="empty-msg">No active Game Day. Schedule one!</p>
          </div>
        </section>
        <section class="card">
          <h3 class="section-title">ğŸ“… Upcoming Game Days</h3>
          <div id="upcoming-gamedays" class="upcoming-gamedays">
            <p class="empty-msg">No upcoming game days scheduled.</p>
          </div>
        </section>
      </div>
    </main>

    <!-- HISTORY TAB -->
    <main class="tab-content" id="cricket-tab-history">
      <div class="history-container">
        <section class="card">
          <h3 class="section-title">ğŸ“œ Match History</h3>
          <div id="history-list" class="history-list">
            <p class="empty-msg">No innings played yet.</p>
          </div>
        </section>
        <section class="card">
          <h3 class="section-title">ğŸŸï¸ Game Day Results</h3>
          <div id="gd-history-list" class="history-list">
            <p class="empty-msg">No game day results yet.</p>
          </div>
        </section>
      </div>
    </main>
  </div><!-- /cricket-app -->


  <!-- =================== COUPLE THEME =================== -->
  <div id="couple-app" class="app-theme hidden">
    <header class="top-nav couple-nav">
      <div class="nav-brand couple-brand">ğŸ’‘ Couple Goals</div>
      <div class="nav-tabs">
        <button class="tab-btn active" data-tab="journey" data-app="couple">ğŸ’— Journey</button>
        <button class="tab-btn" data-tab="partner1" data-app="couple" id="tab-btn-partner1">ğŸ‘¤ Partner 1</button>
        <button class="tab-btn" data-tab="partner2" data-app="couple" id="tab-btn-partner2">ğŸ‘¤ Partner 2</button>
        <button class="tab-btn" data-tab="memories" data-app="couple">ğŸ“– Memories</button>
      </div>
      <div class="nav-date" id="couple-current-date"></div>
    </header>

    <!-- JOURNEY TAB -->
    <main class="tab-content active" id="couple-tab-journey">
      <div class="journey-container">

        <!-- Path Hero -->
        <section class="couple-path-card card">
          <div class="couple-names-row">
            <div class="couple-name-box">
              <div class="partner-avatar p1-avatar">ğŸ’™</div>
              <div class="partner-name-edit" id="p1-name-display" onclick="editPartnerName(1)">Partner 1</div>
            </div>
            <div class="closeness-center">
              <div class="love-meter-val" id="love-meter-val">0%</div>
              <div class="love-meter-label">Closeness</div>
            </div>
            <div class="couple-name-box" style="text-align:right">
              <div class="partner-avatar p2-avatar">â¤ï¸</div>
              <div class="partner-name-edit" id="p2-name-display" onclick="editPartnerName(2)">Partner 2</div>
            </div>
          </div>

          <!-- THE BIG PATH -->
          <div class="big-path-wrapper">
            <svg id="couple-path-svg" viewBox="0 0 800 220" xmlns="http://www.w3.org/2000/svg"
              preserveAspectRatio="xMidYMid meet">
              <!-- Road background -->
              <defs>
                <linearGradient id="roadGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#1e3a5f;stop-opacity:1" />
                  <stop offset="50%" style="stop-color:#7c3aed;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#be123c;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="heartGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#f472b6" />
                  <stop offset="100%" style="stop-color:#ec4899" />
                </linearGradient>
                <filter id="glow-pink">
                  <feGaussianBlur stdDeviation="4" result="blur" />
                  <feMerge>
                    <feMergeNode in="blur" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
                <filter id="glow-blue">
                  <feGaussianBlur stdDeviation="3" result="blur" />
                  <feMerge>
                    <feMergeNode in="blur" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
              </defs>

              <!-- Sky background -->
              <rect width="800" height="220" fill="#0a0f1e" rx="16" />

              <!-- Stars -->
              <circle cx="50" cy="30" r="1.5" fill="white" opacity="0.6" />
              <circle cx="120" cy="15" r="1" fill="white" opacity="0.5" />
              <circle cx="200" cy="40" r="1.2" fill="white" opacity="0.7" />
              <circle cx="350" cy="20" r="1.5" fill="white" opacity="0.4" />
              <circle cx="500" cy="35" r="1" fill="white" opacity="0.6" />
              <circle cx="650" cy="18" r="1.3" fill="white" opacity="0.5" />
              <circle cx="750" cy="42" r="1" fill="white" opacity="0.7" />
              <circle cx="80" cy="60" r="0.8" fill="white" opacity="0.4" />
              <circle cx="680" cy="55" r="0.8" fill="white" opacity="0.4" />

              <!-- Ground road -->
              <rect x="0" y="160" width="800" height="60" fill="#111827" rx="0" />
              <rect x="0" y="155" width="800" height="12" fill="url(#roadGrad)" rx="4" opacity="0.8" />
              <!-- Road markings -->
              <rect x="100" y="160" width="40" height="3" rx="1.5" fill="rgba(255,255,255,0.15)" />
              <rect x="220" y="160" width="40" height="3" rx="1.5" fill="rgba(255,255,255,0.15)" />
              <rect x="340" y="160" width="40" height="3" rx="1.5" fill="rgba(255,255,255,0.15)" />
              <rect x="460" y="160" width="40" height="3" rx="1.5" fill="rgba(255,255,255,0.15)" />
              <rect x="580" y="160" width="40" height="3" rx="1.5" fill="rgba(255,255,255,0.15)" />
              <rect x="700" y="160" width="40" height="3" rx="1.5" fill="rgba(255,255,255,0.15)" />

              <!-- Milestone markers on path -->
              <circle cx="200" cy="157" r="4" fill="rgba(255,255,255,0.2)" />
              <circle cx="400" cy="157" r="5" fill="rgba(244,114,182,0.4)" />
              <circle cx="600" cy="157" r="4" fill="rgba(255,255,255,0.2)" />
              <text x="400" y="148" text-anchor="middle" font-size="10" fill="rgba(244,114,182,0.7)">Meeting
                Point</text>

              <!-- Heart in center (shown at high closeness) -->
              <g id="center-heart" opacity="0.2">
                <path
                  d="M400 120 C400 120 380 105 380 95 C380 87 387 82 395 85 C398 86 400 88 400 88 C400 88 402 86 405 85 C413 82 420 87 420 95 C420 105 400 120 400 120Z"
                  fill="url(#heartGrad)" filter="url(#glow-pink)" />
              </g>

              <!-- P1 character (moves from left) -->
              <g id="p1-char" transform="translate(40, 110)">
                <!-- Body -->
                <circle cx="0" cy="-8" r="14" fill="#3b82f6" filter="url(#glow-blue)" />
                <circle cx="0" cy="-8" r="10" fill="#60a5fa" />
                <!-- Face -->
                <circle cx="-3" cy="-9" r="2" fill="#1e3a8a" />
                <circle cx="3" cy="-9" r="2" fill="#1e3a8a" />
                <path d="M-3 -5 Q0 -3 3 -5" stroke="#1e3a8a" stroke-width="1.2" fill="none" />
                <!-- Name tag -->
                <text id="p1-svg-label" x="0" y="10" text-anchor="middle" font-size="9" fill="#93c5fd"
                  font-family="Inter, sans-serif">P1</text>
              </g>

              <!-- P2 character (moves from right) -->
              <g id="p2-char" transform="translate(760, 110)">
                <circle cx="0" cy="-8" r="14" fill="#ec4899" filter="url(#glow-pink)" />
                <circle cx="0" cy="-8" r="10" fill="#f9a8d4" />
                <circle cx="-3" cy="-9" r="2" fill="#9d174d" />
                <circle cx="3" cy="-9" r="2" fill="#9d174d" />
                <path d="M-3 -5 Q0 -3 3 -5" stroke="#9d174d" stroke-width="1.2" fill="none" />
                <text id="p2-svg-label" x="0" y="10" text-anchor="middle" font-size="9" fill="#f9a8d4"
                  font-family="Inter, sans-serif">P2</text>
              </g>

              <!-- Connection line between them -->
              <line id="couple-connect-line" x1="40" y1="110" x2="760" y2="110" stroke="rgba(244,114,182,0.15)"
                stroke-width="2" stroke-dasharray="8,6" />
            </svg>
          </div>

          <!-- Love Meter Bar -->
          <div class="love-meter-bar-wrap">
            <span class="love-meter-end">ğŸ’™ Apart</span>
            <div class="love-meter-track">
              <div class="love-meter-fill" id="love-meter-fill"></div>
              <div class="love-meter-thumb" id="love-meter-thumb">ğŸ’—</div>
            </div>
            <span class="love-meter-end">Together ğŸ’—</span>
          </div>
          <div class="nudge-section" style="text-align: center; margin-top: 15px;">
            <button class="btn-nudge" id="btn-send-nudge" title="Send a little love nudge to your partner!">ğŸ’Œ Send Love
              Nudge</button>
          </div>
        </section>

        <!-- Couple Stats -->
        <section class="card couple-stats-card">
          <h3 class="section-title couple-title">âœ¨ Couple Stats</h3>
          <div class="stats-row">
            <div class="stat-box couple-stat">
              <div class="stat-icon">ğŸ’—</div>
              <div class="stat-val" id="c-stat-closeness">0%</div>
              <div class="stat-lbl">Closeness</div>
            </div>
            <div class="stat-box couple-stat">
              <div class="stat-icon">ğŸ”¥</div>
              <div class="stat-val" id="c-stat-streak">0</div>
              <div class="stat-lbl">Couple Streak</div>
            </div>
            <div class="stat-box couple-stat">
              <div class="stat-icon">â­</div>
              <div class="stat-val" id="c-stat-best">0</div>
              <div class="stat-lbl">Best Streak</div>
            </div>
            <div class="stat-box couple-stat">
              <div class="stat-icon">ğŸ“…</div>
              <div class="stat-val" id="c-stat-days">0</div>
              <div class="stat-lbl">Days Together</div>
            </div>
            <div class="stat-box couple-stat">
              <div class="stat-icon">ğŸ’«</div>
              <div class="stat-val" id="c-stat-p1done">0%</div>
              <div class="stat-lbl">P1 Today</div>
            </div>
            <div class="stat-box couple-stat">
              <div class="stat-icon">ğŸŒ¸</div>
              <div class="stat-val" id="c-stat-p2done">0%</div>
              <div class="stat-lbl">P2 Today</div>
            </div>
          </div>
        </section>

        <!-- Milestone Unlocks -->
        <section class="card">
          <h3 class="section-title couple-title">ğŸ… Love Milestones</h3>
          <div class="unlocks-grid">
            <div class="unlock-item locked" data-cunlock="wave" title="First Wave â€“ 3-day couple streak">ğŸ‘‹</div>
            <div class="unlock-item locked" data-cunlock="smile" title="First Smile â€“ 7-day streak">ğŸ˜Š</div>
            <div class="unlock-item locked" data-cunlock="hands" title="Holding Hands â€“ 14-day streak">ğŸ¤</div>
            <div class="unlock-item locked" data-cunlock="hug" title="First Hug â€“ 21-day streak">ğŸ¤—</div>
            <div class="unlock-item locked" data-cunlock="heart" title="Deep Connection â€“ 30-day streak">ğŸ’—</div>
            <div class="unlock-item locked" data-cunlock="ring" title="Soulmates â€“ 50-day streak">ğŸ’</div>
          </div>
        </section>
      </div>
    </main>

    <!-- PARTNER 1 TAB -->
    <main class="tab-content" id="couple-tab-partner1">
      <div class="partner-tab-container">
        <!-- Card 1: Manage Profile & Habits (Settings) -->
        <section class="card p1-card">
          <div class="partner-header"
            style="border-bottom: 1px solid var(--card-border); padding-bottom: 15px; margin-bottom: 15px;">
            <div class="partner-avatar-lg p1-avatar">ğŸ’™</div>
            <div class="partner-header-info">
              <div class="partner-name-input-row">
                <input type="text" id="p1-name-input" class="partner-name-input p1-name-input"
                  placeholder="Partner 1 name..." maxlength="20" value="Partner 1" />
              </div>
              <div class="partner-tab-meta">ğŸ‘¤ Profile Settings</div>
              <div class="milestones-shelf" id="p1-milestones"></div>
            </div>
          </div>

          <div class="partner-section-label">ğŸ“‹ Add/Manage Habits</div>
          <div class="add-habit-form">
            <input type="text" id="p1-habit-input" placeholder="Add habit..." maxlength="50" />
            <select id="p1-habit-cat">
              <option value="health">ğŸƒ Health</option>
              <option value="mind">ğŸ§  Mind</option>
              <option value="skill">âš¡ Skill</option>
              <option value="social">ğŸ‘¥ Social</option>
              <option value="other">ğŸ¯ Other</option>
            </select>
            <button class="btn-couple-primary" id="btn-add-p1-habit">Add Habit</button>
          </div>

          <div class="partner-section-divider"></div>

          <div class="sync-settings-group">
            <label class="daily-note-label">ğŸŒ Cloud Sync (Multi-Device)</label>
            <div class="sync-input-row">
              <input type="password" id="p1-sync-key" placeholder="Enter shared Couple Key..." maxlength="50" />
              <button class="btn-sync" id="btn-sync-p1" title="Link devices using this key">Link</button>
            </div>
            <p class="sync-status" id="p1-sync-status">ğŸ“¡ Local Mode (Private)</p>
          </div>
        </section>

        <!-- Card 2: Today's Check-In (Daily Tracking) -->
        <section class="card p1-card">
          <div class="partner-section-label">ğŸ“… Today's Check-In</div>
          <div class="partner-tab-meta" style="margin-bottom: 15px;">Today's Progress: <span id="p1-today-pct">0%</span>
          </div>

          <!-- Journal FIRST -->
          <div class="daily-note-section">
            <label class="daily-note-label" for="p1-day-note">ğŸ“ How was your day?</label>
            <textarea id="p1-day-note" class="daily-note-textarea p1-note"
              placeholder="Write anything... your mood, a win, a challenge, something you're grateful for ğŸ’™"
              maxlength="500" rows="3"></textarea>
            <div class="note-char-count"><span id="p1-note-count">0</span>/500</div>

            <div class="gallery-input-group">
              <label class="daily-note-label" for="p1-photo-url">ğŸ“¸ Memory Photo (URL)</label>
              <input type="text" id="p1-photo-url" class="gallery-url-input" placeholder="Paste image link here..." />
            </div>
          </div>

          <div class="partner-section-divider"></div>

          <!-- Habits list with lock overlay -->
          <div class="habits-lock-container" id="p1-habits-container">
            <div id="p1-habits-list" class="today-habits-list">
              <p class="empty-msg">No habits yet. Add some above!</p>
            </div>
            <div class="habits-lock-overlay" id="p1-lock-overlay">
              <div class="lock-msg">ğŸ“ Write your journal first to take the score</div>
            </div>
          </div>

          <button class="btn-couple-primary btn-submit-partner" id="btn-submit-p1">Submit Partner 1 Day ğŸ’™</button>
          <button class="btn-reopen-day hidden" id="btn-reopen-p1">âœï¸ Re-open to Edit</button>
        </section>
      </div>
    </main>

    <!-- PARTNER 2 TAB -->
    <main class="tab-content" id="couple-tab-partner2">
      <div class="partner-tab-container">
        <!-- Card 1: Manage Profile & Habits (Settings) -->
        <section class="card p2-card">
          <div class="partner-header"
            style="border-bottom: 1px solid var(--card-border); padding-bottom: 15px; margin-bottom: 15px;">
            <div class="partner-avatar-lg p2-avatar">â¤ï¸</div>
            <div class="partner-header-info">
              <div class="partner-name-input-row">
                <input type="text" id="p2-name-input" class="partner-name-input p2-name-input"
                  placeholder="Partner 2 name..." maxlength="20" value="Partner 2" />
              </div>
              <div class="partner-tab-meta">ğŸ‘¤ Profile Settings</div>
              <div class="milestones-shelf" id="p2-milestones"></div>
            </div>
          </div>

          <div class="partner-section-label">ğŸ“‹ Add/Manage Habits</div>
          <div class="add-habit-form">
            <input type="text" id="p2-habit-input" placeholder="Add habit..." maxlength="50" />
            <select id="p2-habit-cat">
              <option value="health">ğŸƒ Health</option>
              <option value="mind">ğŸ§  Mind</option>
              <option value="skill">âš¡ Skill</option>
              <option value="social">ğŸ‘¥ Social</option>
              <option value="other">ğŸ¯ Other</option>
            </select>
            <button class="btn-couple-secondary btn-couple-add" id="btn-add-p2-habit">Add Habit</button>
          </div>

          <div class="partner-section-divider"></div>

          <div class="sync-settings-group">
            <label class="daily-note-label">ğŸŒ Cloud Sync (Multi-Device)</label>
            <div class="sync-input-row">
              <input type="password" id="p2-sync-key" placeholder="Enter shared Couple Key..." maxlength="50" />
              <button class="btn-sync" id="btn-sync-p2" title="Link devices using this key">Link</button>
            </div>
            <p class="sync-status" id="p2-sync-status">ğŸ“¡ Local Mode (Private)</p>
          </div>
        </section>

        <!-- Card 2: Today's Check-In (Daily Tracking) -->
        <section class="card p2-card">
          <div class="partner-section-label">ğŸ“… Today's Check-In</div>
          <div class="partner-tab-meta" style="margin-bottom: 15px;">Today's Progress: <span id="p2-today-pct">0%</span>
          </div>

          <!-- Journal FIRST -->
          <div class="daily-note-section">
            <label class="daily-note-label" for="p2-day-note">ğŸ“ How was your day?</label>
            <textarea id="p2-day-note" class="daily-note-textarea p2-note"
              placeholder="Write anything... your mood, a win, a challenge, something you're grateful for â¤ï¸"
              maxlength="500" rows="3"></textarea>
            <div class="note-char-count"><span id="p2-note-count">0</span>/500</div>

            <div class="gallery-input-group">
              <label class="daily-note-label" for="p2-photo-url">ğŸ“¸ Memory Photo (URL)</label>
              <input type="text" id="p2-photo-url" class="gallery-url-input" placeholder="Paste image link here..." />
            </div>
          </div>

          <div class="partner-section-divider"></div>

          <!-- Habits list with lock overlay -->
          <div class="habits-lock-container" id="p2-habits-container">
            <div id="p2-habits-list" class="today-habits-list">
              <p class="empty-msg">No habits yet. Add some above!</p>
            </div>
            <div class="habits-lock-overlay" id="p2-lock-overlay">
              <div class="lock-msg">ğŸ“ Write your journal first to take the score</div>
            </div>
          </div>

          <button class="btn-couple-secondary btn-submit-partner" id="btn-submit-p2">Submit Partner 2 Day â¤ï¸</button>
          <button class="btn-reopen-day hidden" id="btn-reopen-p2">âœï¸ Re-open to Edit</button>
        </section>
      </div>
    </main>

    <!-- MEMORIES TAB -->
    <main class="tab-content" id="couple-tab-memories">
      <div class="history-container">
        <div class="chart-container">
          <div class="chart-header">
            <h3 class="section-title couple-title" style="margin: 0;">ğŸ“ˆ Growth Trends</h3>
            <span class="text-xs text-dim">Closeness (Last 30 Days)</span>
          </div>
          <canvas id="growthChart" height="150"></canvas>
        </div>
        <section class="card">
          <h3 class="section-title couple-title">ğŸ“– Our Journey Log</h3>
          <div id="couple-history-list" class="history-list">
            <p class="empty-msg">No entries yet. Start your journey together!</p>
          </div>
        </section>
      </div>
    </main>
  </div><!-- /couple-app -->

  <!-- Confirm Modal -->
  <div id="confirm-modal" class="modal-overlay hidden">
    <div class="modal-box">
      <h3 id="modal-title">Confirm</h3>
      <p id="modal-msg"></p>
      <div class="modal-actions">
        <button class="btn-secondary" id="modal-cancel">Cancel</button>
        <button class="btn-danger" id="modal-confirm">Confirm</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>

</html>